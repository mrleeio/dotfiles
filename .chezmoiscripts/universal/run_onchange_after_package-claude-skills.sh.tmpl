#!/bin/bash
{{ template "shell-header.sh" . }}

# Package Claude skills for desktop app upload
# Hash: {{ include "dot_claude/skills/conventional-commits/SKILL.md" | sha256sum }}

echo "Packaging Claude skills for desktop app upload..."

SKILLS_DIR="$HOME/.claude/skills"
OUTPUT_DIR="$HOME/.claude/packaged-skills"

# Create output directory if it doesn't exist
mkdir -p "$OUTPUT_DIR"

# Package conventional-commits skill
if [ -d "$SKILLS_DIR/conventional-commits" ]; then
    cd "$SKILLS_DIR"

    # Create zip file with timestamp
    TIMESTAMP=$(date +%Y%m%d)
    ZIP_FILE="$OUTPUT_DIR/conventional-commits-${TIMESTAMP}.zip"

    # Remove old zip files for this skill
    rm -f "$OUTPUT_DIR"/conventional-commits-*.zip

    # Create new zip file
    zip -r "$ZIP_FILE" conventional-commits/ > /dev/null 2>&1

    if [ -f "$ZIP_FILE" ]; then
        echo "✓ Packaged conventional-commits skill → $ZIP_FILE"
        echo "  Upload this file to Claude desktop app when needed"
    else
        echo "⚠ Failed to package conventional-commits skill"
        exit 1
    fi
else
    echo "⚠ conventional-commits skill directory not found"
fi

echo ""
echo "Packaged skills are available at: $OUTPUT_DIR"
echo "To upload: Open Claude desktop app → Skills → Upload skill"
